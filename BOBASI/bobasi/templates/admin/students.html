{% extends 'admin/base.html' %}
{% block title %}Students — Bobasi BBS{% endblock %}
{% block page_title %}Students{% endblock %}
{% block content %}
<div class="card">
  <div class="card-header">
    <h3>All Registered Students</h3>
    <form method="GET" style="display:flex;gap:8px;">
      <input type="text" name="search" value="{{ search }}" placeholder="Search name, admission no., institution..." class="search-input">
      <button type="submit" class="btn btn-primary btn-sm">Search</button>
      {% if search %}<a href="{{ url_for('admin.students') }}" class="btn btn-sm btn-outline">Clear</a>{% endif %}
    </form>
  </div>
  <div class="table-wrap">
    <table class="admin-table">
      <thead><tr><th>#</th><th>Name</th><th>Admission No.</th><th>Institution</th><th>Sub-County</th><th>Phone</th><th>Applications</th><th>Profile</th><th></th></tr></thead>
      <tbody>
        {% for s in students %}
        <tr>
          <td>{{ loop.index }}</td>
          <td><strong>{{ s.full_name }}</strong></td>
          <td>{{ s.admission_number or '—' }}</td>
          <td>{{ (s.institution or '')[:25] }}{% if (s.institution or '')|length > 25 %}...{% endif %}</td>
          <td>{{ s.sub_county or '—' }}</td>
          <td>{{ s.phone or '—' }}</td>
          <td><span class="badge badge-pending">{{ s.applications.count() }}</span></td>
          <td>{% if s.profile_complete %}<span class="badge badge-approved">✓ Complete</span>{% else %}<span class="badge badge-rejected">Incomplete</span>{% endif %}</td>
          <td><a href="{{ url_for('admin.view_student', student_id=s.id) }}" class="btn-xs">View</a></td>
        </tr>
        {% else %}
        <tr><td colspan="9" class="no-data">No students found.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <div class="table-footer">Total: <strong>{{ students|length }}</strong> students</div>
</div>
{% endblock %}
